<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Profile - Artfolio</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body class="edit-profilebody">
  <div class="profile-edit-container">
    <div class="banner-wrapper" id="bannerPreviewContainer">
      {% if user.banner_image %}
      <img src="{{ user.banner_image }}" alt="Banner preview" id="bannerPreview">
      {% else %}
      <div class="d-flex align-items-center justify-content-center h-100 text-muted">
        <i class="fas fa-image me-2"></i> No banner uploaded
      </div>
      {% endif %}

      <div class="avatar-wrapper">
        <img src="{{ user.profile_image }}" alt="Avatar preview" id="avatarPreview">
      </div>
    </div>

    <div class="profile-content w-85 mx-auto">
      <h3><i class="fas fa-user-edit text-primary me-2"></i>Edit Profile</h3>
      
      <form method="POST" enctype="multipart/form-data" id="profileForm" class="w-100">
        <div class="mb-3">
          <label for="banner_image" class="form-label">Banner Image URL</label>
          <input type="url" class="form-control" id="banner_image" name="banner_image"
                 value="{{ user.banner_image if user.banner_image }}"
                 placeholder="https://example.com/banner.jpg">
          <div class="form-text">Recommended: 1200×300 px</div>
        </div>

        <div class="mb-4">
          <label for="profile_image" class="form-label">Profile Image URL *</label>
          <input type="url" class="form-control" id="profile_image" name="profile_image"
                 value="{{ user.profile_image }}"
                 placeholder="https://example.com/avatar.jpg" required>
          <div class="form-text">Recommended: 128×128 px (square)</div>
        </div>

        <div class="section-divider"></div>
        <div class="mb-4">
          <label for="bio" class="form-label">Bio</label>
          <textarea class="form-control" id="bio" name="bio" rows="4"
                    placeholder="Write a short bio about yourself...">{{ user.bio if user.bio }}</textarea>
        </div>
        <div class="section-divider"></div>

        <h5 class="mb-3">Social Links</h5>
        <div class="social-input">
          <div class="icon website"><i class="fas fa-globe"></i></div>
          <input type="url" class="form-control" id="website" name="website"
                 value="{{ user.social_links.website if user.social_links and user.social_links.website }}"
                 placeholder="https://your-website.com">
        </div>

        <div class="social-input">
          <div class="icon instagram"><i class="fab fa-instagram"></i></div>
          <input type="url" class="form-control" id="instagram" name="instagram"
                 value="{{ user.social_links.instagram if user.social_links and user.social_links.instagram }}"
                 placeholder="https://instagram.com/yourusername">
        </div>

        <div class="social-input">
          <div class="icon twitter"><i class="fab fa-twitter"></i></div>
          <input type="url" class="form-control" id="twitter" name="twitter"
                 value="{{ user.social_links.twitter if user.social_links and user.social_links.twitter }}"
                 placeholder="https://twitter.com/yourusername">
        </div>

        <div class="d-flex justify-content-between align-items-center mt-4">
          <a href="{{ url_for('profile', user_id=current_user.id) }}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i> Cancel
          </a>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-1"></i> Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(function() {
      $('#banner_image').on('input', function() {
        const url = $(this).val();
        const container = $('#bannerPreviewContainer');
        if (url) {
          container.html(`<img src="${url}" alt="Banner preview" id="bannerPreview">`);
        } else {
          container.html(`<div class="d-flex align-items-center justify-content-center h-100 text-muted"><i class="fas fa-image me-2"></i>No banner uploaded</div>`);
        }
      });

      $('#profile_image').on('input', function() {
        const url = $(this).val();
        $('#avatarPreview').attr('src', url);
      });

      $('#profileForm').on('submit', function(e) {
        if (!$('#profile_image').val().trim()) {
          e.preventDefault();
          alert('Please provide a profile image URL');
        }
      });
    });
  </script>
</body>
</html>
